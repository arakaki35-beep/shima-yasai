<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>æ²–ç¸„é’æœå¸‚æ³ | ã—ã‚“ã›ã‚“å³¶é‡èœ</title>
  <link rel="stylesheet" href="css/sanitize.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
    
  <!-- Chart.jsã‚’headã§èª­ã¿è¾¼ã¿ -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz" crossorigin="anonymous"></script>
    
  <style>
        header{
            background-color: #3d9b11;
            color: white;
            padding: 10px;
        }

         .vegetable-selector {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .filter-section {
            background-color: white;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }
        
        .search-box {
            position: relative;
            margin-bottom: 15px;
        }
        
        .search-box input {
            padding-left: 40px;
        }
        
        .search-box .search-icon {
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: #6c757d;
        }
        
        .category-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 15px;
        }
        
        .category-btn {
            padding: 6px 12px;
            border: 1px solid #dee2e6;
            background-color: white;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.9rem;
        }
        
        .category-btn:hover {
            background-color: #e9ecef;
        }
        
        .category-btn.active {
            background-color: #0d6efd;
            color: white;
            border-color: #0d6efd;
        }
        
        .price-filter {
            display: flex;
            align-items: center;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }
        
        .price-input {
            width: 100px;
            font-size: 0.9rem;
        }
        
        .checkbox-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 10px;
            max-height: 300px;
            overflow-y: auto;
            padding: 10px;
            border: 1px solid #e0e0e0;
            border-radius: 5px;
            background-color: white;
        }
        
        .vegetable-checkbox {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 5px;
            border-radius: 3px;
            transition: background-color 0.2s;
        }
        
        .vegetable-checkbox:hover {
            background-color: #f0f0f0;
        }
        
        .vegetable-checkbox input[type="checkbox"] {
            margin: 0;
        }
        
        .vegetable-checkbox .price-info {
            font-size: 0.8rem;
            color: #6c757d;
            margin-left: auto;
        }
        
        .control-buttons {
            margin-top: 15px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            align-items: center;
        }
        
        .btn-sm {
            padding: 5px 15px;
            font-size: 0.9rem;
        }
        
        .chart-container {
            position: relative;
            height: 400px;
            margin-top: 20px;
        }
        
        .hidden {
            display: none !important;
        }
        
        .stats-info {
            display: flex;
            gap: 20px;
            align-items: center;
            font-size: 0.9rem;
            color: #6c757d;
        }
               
        footer {
            bottom: 0;
            width: 100%;
            height: 100px;
            background: #2769a0;
            color: white;
            padding: 30px;
        }

        @media (max-width: 768px) {
            .checkbox-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
                max-height: 200px;
            }
            
            .control-buttons {
                justify-content: center;
            }
            
            .category-buttons {
                justify-content: center;
            }
            
            .price-filter {
                justify-content: center;
            }
            
            .stats-info {
                flex-direction: column;
                gap: 5px;
                text-align: center;
            }
        }
  </style>
</head>
<body>
  <header>
    <h1>æ²–ç¸„çœŒ é‡èœå¸‚æ³ãƒãƒ£ãƒ¼ãƒˆ</h1>
  </header>
    
  <div class="container-fluid px-3">
    <!-- é‡èœé¸æŠã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
    <div class="vegetable-selector">
      <h3 class="mb-3">è¡¨ç¤ºã™ã‚‹é‡èœã‚’é¸æŠã—ã¦ãã ã•ã„</h3>
            
      <!-- ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
      <div class="filter-section">
        <!-- æ¤œç´¢ãƒœãƒƒã‚¯ã‚¹ -->
        <div class="search-box">
          <span class="search-icon">ğŸ”</span>
          <input type="text" id="searchInput" class="form-control" placeholder="é‡èœåã§æ¤œç´¢...">
        </div>
                
        <!-- ã‚«ãƒ†ã‚´ãƒªãƒœã‚¿ãƒ³ -->
        <div class="category-buttons">
          <button class="category-btn active" data-category="all">å…¨ã¦</button>
          <button class="category-btn" data-category="leafy">è‘‰èœé¡</button>
          <button class="category-btn" data-category="root">æ ¹èœé¡</button>
          <button class="category-btn" data-category="fruit">æœèœé¡</button>
          <button class="category-btn" data-category="mushroom">ãã®ã“é¡</button>
          <button class="category-btn" data-category="herb">é¦™å‘³é‡èœ</button>
          <button class="category-btn" data-category="other">ãã®ä»–</button>
        </div>
                
        <!-- ä¾¡æ ¼å¸¯ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ -->
        <div class="price-filter">
          <span>ä¾¡æ ¼å¸¯:</span>
          <input type="number" id="minPrice" class="form-control price-input" placeholder="æœ€ä½ä¾¡æ ¼" min="0">
          <span>ã€œ</span>
          <input type="number" id="maxPrice" class="form-control price-input" placeholder="æœ€é«˜ä¾¡æ ¼" min="0">
          <span>å††/kg</span>
          <button id="resetPriceFilter" class="btn btn-outline-secondary btn-sm">ãƒªã‚»ãƒƒãƒˆ</button>
        </div>
      </div>
            
      <!-- åˆ¶å¾¡ãƒœã‚¿ãƒ³ -->
      <div class="control-buttons">
        <button id="selectAll" class="btn btn-primary btn-sm">å…¨ã¦é¸æŠ</button>
        <button id="deselectAll" class="btn btn-secondary btn-sm">å…¨ã¦è§£é™¤</button>
        <button id="selectVisible" class="btn btn-info btn-sm">è¡¨ç¤ºä¸­ã‚’é¸æŠ</button>
        <div class="stats-info">
          <span>é¸æŠæ•°: <span id="selectedCount">0</span></span>
          <span>è¡¨ç¤ºä¸­: <span id="visibleCount">0</span></span>
          <span>ç·æ•°: <span id="totalCount">0</span></span>
        </div>
      </div>
            
      <!-- ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã‚°ãƒªãƒƒãƒ‰ -->
      <div id="vegetableCheckboxes" class="checkbox-grid">
        <div class="text-center text-muted">é‡èœãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ä¸­...</div>
      </div>
    </div>
        
    <!-- ã‚°ãƒ©ãƒ•ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
    <div class="chart-container">
      <canvas id="vegetableChart"></canvas>
    </div>
        
    <p class="mt-3">å‡ºå±•ï¼š<span><a href="https://www.pref.okinawa.lg.jp/shigoto/shinkooroshi/1011552/1024140/1024142.html">æ²–ç¸„çœŒ|å¸‚æ³æƒ…å ±ï¼ˆä¸­å¤®å¸å£²å¸‚å ´ï¼‰</a></span></p>
    <p>1kgè¾ºã‚Šã®ä¾¡æ ¼ã‚’è¡¨ç¤ºã—ã¦ã„ã¾ã™<br>å¼Šç¤¾ã§ã¯æƒ…å ±ã®ç²¾åº¦ã‚’ä¿è¨¼ã§ãã‹ã­ã¾ã™ã€‚ã‚ãã¾ã§å‚è€ƒæƒ…å ±ã¨ã—ã¦ã”åˆ©ç”¨ãã ã•ã„ã€‚</p>
  </div>
    
  <footer class="mt-5">
    <p>æä¾›ï¼šç ‚å·å•†åº—åˆåŒä¼šç¤¾<br>TELï¼š098-850-5735</p>
  </footer>
    
  <script>
	let chartInstance = null;
	// â˜…â˜…â˜… ã“ã“ã«ã‚ãªãŸã®GAS URLã‚’å…¥ã‚Œã‚‹ â˜…â˜…â˜…
	const API_BASE_URL = 'https://script.google.com/macros/s/AKfycbwqyKyWKhGcS377C9XsPhoyjoG5GsJx8EMCd9qsazoanInvnvDcp1aWtgvVAUEZdLQ7/exec';
	let allVegetableData = {};
	let allDates = [];
	let availableVegetables = [];
	let vegetablePrices = {};
	let isDataReady = false;

	const colors = [
	  '#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF',
	  '#FF9F40', '#FF6384', '#C9CBCF', '#4BC0C0', '#FF6384',
	  '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF', '#FF9F40',
	  '#8E44AD', '#E74C3C', '#F39C12', '#27AE60', '#3498DB',
	  '#E67E22', '#95A5A6', '#34495E', '#9B59B6', '#1ABC9C'
	];

	const vegetableCategories = {
	  leafy:  ['ãƒ¬ã‚¿ã‚¹', 'ã‚­ãƒ£ãƒ™ãƒ„', 'ç™½èœ', 'ã»ã†ã‚Œã‚“ãã†', 'ã“ã¾ã¤ãª', 'ï¼Šãƒãƒ³ã‚²ãƒ³ã‚µã‚¤', 'æ°´èœ', 'ã‚»ãƒ«ãƒªãƒ¼', 'ã­ã','ï¼Šé’ã­ã', 'ãŸã¾ã­ã', 'ãƒ‹ãƒ©', 'ã‚‚ã‚„ã—', 'æ˜¥èŠ', 'å¤§æ ¹è‘‰', 'ã‹ã¶è‘‰','ã‹ã‚‰ã—ãª','ã‚‰ã£ãã‚‡ã†'],
	  root:  ['é’é¦–å¤§æ ¹', 'ã«ã‚“ã˜ã‚“','å³¶ã«ã‚“ã˜ã‚“', 'ï¼Šã°ã‚Œã„ã—ã‚‡', 'ï¼Šã‹ã‚“ã—ã‚‡', 'ã‹ã¶', 'ã”ã¼ã†', 'ã‚Œã‚“ã“ã‚“', 'é‡Œã„ã‚‚', 'é•·ã„ã‚‚', 'å±±ã„ã‚‚','ç”°èŠ‹'],
	  fruit: ['ãƒˆãƒãƒˆ', 'ï¼Šãã‚…ã†ã‚Š', 'ï¼Šãªã™', 'ï¼Šãƒ”ãƒ¼ãƒãƒ³', 'ãƒ‘ãƒ—ãƒªã‚«', 'ã—ã—ã¨ã†', 'ï¼Šã‚ªã‚¯ãƒ©', 'ã‚ºãƒƒã‚­ãƒ¼ãƒ‹', 'ã¨ã†ãŒã‚“', 'ã‹ã¼ã¡ã‚ƒ','æ´‹ç¨®ã‹ã¼ã¡ã‚ƒ', 'ï¼Šã‚¤ãƒ³ã‚²ãƒ³', 'ãˆã‚“ã©ã†', 'ãã‚‰è±†', 'ã¨ã†ã‚‚ã‚ã“ã—','ï¼Šã‚´ãƒ¼ãƒ¤ãƒ¼','ã¸ã¡ã¾','ãƒ‘ãƒ‘ã‚¤ãƒ¤'],
	  mushroom: ['ã—ã„ãŸã‘', 'ãˆã®ã', 'ã—ã‚ã˜', 'ã¾ã„ãŸã‘', 'ã‚¨ãƒªãƒ³ã‚®', 'ãªã‚ã“', 'ããã‚‰ã’'],
	  herb: ['ã—ã‚‡ã†ãŒ', 'ã«ã‚“ã«ã', 'å¤§è‘‰', 'ãƒ‘ã‚»ãƒª', 'ã¿ã¤ã°', 'ã‚ã•ã³', 'ã¿ã‚‡ã†ãŒ'],
	  other: []
	};

// é‡èœä¸€è¦§ã¨ä¾¡æ ¼ã‚’å–å¾—ï¼ˆæ”¹è‰¯ç‰ˆï¼‰
	async function loadVegetableList() {
	  try {
	    console.log('é‡èœä¸€è¦§ã¨ä¾¡æ ¼ã‚’å–å¾—ä¸­...');
	    
		const response = await fetch(`${API_BASE_URL}?path=vegetables-list-with-prices`);
	    const result = await response.json();
	    
	    if (result.status === 'success') {
	      availableVegetables = result.data.list;
	      vegetablePrices = result.data.prices;
	      
	      // ã‚«ãƒ†ã‚´ãƒªåˆ†é¡ã«å«ã¾ã‚Œãªã„é‡èœã‚’ã€Œãã®ä»–ã€ã«è¿½åŠ 
	      const categorizedVegetables = new Set();
	      Object.values(vegetableCategories).forEach(category => {
	        category.forEach(veg => categorizedVegetables.add(veg));
	      });
	      
	      availableVegetables.forEach(veg => {
	        if (!categorizedVegetables.has(veg)) {
	          vegetableCategories.other.push(veg);
	        }
	      });
	      
	      createCheckboxes(availableVegetables);
	      updateTotalCount();
	      console.log(`${availableVegetables.length}ç¨®é¡ã®é‡èœã‚’å–å¾—`);
	    } else {
	      console.error('é‡èœä¸€è¦§å–å¾—ã‚¨ãƒ©ãƒ¼:', result);
	      document.getElementById('vegetableCheckboxes').innerHTML = 
	        '<div class="text-center text-danger">é‡èœä¸€è¦§ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ</div>';
	    }
	    
	  } catch (error) {
	    console.error('é‡èœä¸€è¦§å–å¾—ã‚¨ãƒ©ãƒ¼:', error);
	    document.getElementById('vegetableCheckboxes').innerHTML = 
	      '<div class="text-center text-danger">é‡èœä¸€è¦§ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ</div>';
	  }
	}

	// ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã‚’ç”Ÿæˆ
	function createCheckboxes(vegetables) {
	  const container = document.getElementById('vegetableCheckboxes');
	  container.innerHTML = '';
	  
	  vegetables.forEach((vegetable, index) => {
	    const checkboxDiv = document.createElement('div');
	    checkboxDiv.className = 'vegetable-checkbox';
	    checkboxDiv.dataset.vegetable = vegetable;
	    
	    const checkbox = document.createElement('input');
	    checkbox.type = 'checkbox';
	    checkbox.id = `veg_${index}`;
	    checkbox.value = vegetable;
	    checkbox.checked = false;
	    checkbox.addEventListener('change', updateChart);
	    
	    const label = document.createElement('label');
	    label.htmlFor = `veg_${index}`;
	    label.textContent = vegetable;
	    label.style.cursor = 'pointer';
	    label.style.marginBottom = '0';
	    label.style.flex = '1';
	    
	    const priceInfo = document.createElement('span');
	    priceInfo.className = 'price-info';
	    const priceData = vegetablePrices[vegetable];
	    if (priceData) {
	      priceInfo.textContent = `Â¥${priceData.price}/kg`;
	    }
	    
	    checkboxDiv.appendChild(checkbox);
	    checkboxDiv.appendChild(label);
	    checkboxDiv.appendChild(priceInfo);
	    container.appendChild(checkboxDiv);
	  });
	  
	  updateSelectedCount();
	  updateVisibleCount();
	}

	// ã‚«ã‚¦ãƒ³ãƒˆæ›´æ–°é–¢æ•°
	function updateSelectedCount() {
	  const checkboxes = document.querySelectorAll('#vegetableCheckboxes input[type="checkbox"]:checked');
	  document.getElementById('selectedCount').textContent = checkboxes.length;
	}

	function updateVisibleCount() {
	  const visibleCheckboxes = document.querySelectorAll('#vegetableCheckboxes .vegetable-checkbox:not(.hidden)');
	  document.getElementById('visibleCount').textContent = visibleCheckboxes.length;
	}

	function updateTotalCount() {
	  document.getElementById('totalCount').textContent = availableVegetables.length;
	}

	// æ¤œç´¢æ©Ÿèƒ½
	document.getElementById('searchInput').addEventListener('input', function() {
	  const searchTerm = this.value.toLowerCase();
	  const checkboxes = document.querySelectorAll('.vegetable-checkbox');
	  
	  checkboxes.forEach(checkboxDiv => {
	    const vegetableName = checkboxDiv.dataset.vegetable.toLowerCase();
	    if (vegetableName.includes(searchTerm)) {
	      checkboxDiv.classList.remove('hidden');
	    } else {
	      checkboxDiv.classList.add('hidden');
	    }
	  });
	  
	  updateVisibleCount();
	});

	// ã‚«ãƒ†ã‚´ãƒªãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
	document.querySelectorAll('.category-btn').forEach(btn => {
	  btn.addEventListener('click', function() {
	    document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('active'));
	    this.classList.add('active');
	    
	    const category = this.dataset.category;
	    const checkboxes = document.querySelectorAll('.vegetable-checkbox');
	    
	    checkboxes.forEach(checkboxDiv => {
	      const vegetableName = checkboxDiv.dataset.vegetable;
	      
	      if (category === 'all') {
	        checkboxDiv.classList.remove('hidden');
	      } else {
	        if (vegetableCategories[category] && vegetableCategories[category].includes(vegetableName)) {
	          checkboxDiv.classList.remove('hidden');
	        } else {
	          checkboxDiv.classList.add('hidden');
	        }
	      }
	    });
	    
	    updateVisibleCount();
	  });
	});

	// ä¾¡æ ¼å¸¯ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
	function applyPriceFilter() {
	  const minPrice = parseFloat(document.getElementById('minPrice').value) || 0;
	  const maxPrice = parseFloat(document.getElementById('maxPrice').value) || Infinity;
	  
	  const checkboxes = document.querySelectorAll('.vegetable-checkbox');
	  
	  checkboxes.forEach(checkboxDiv => {
	    const vegetableName = checkboxDiv.dataset.vegetable;
	    const priceData = vegetablePrices[vegetableName];
	    
	    if (priceData && priceData.price !== undefined) {
	      if (priceData.price >= minPrice && priceData.price <= maxPrice) {
	        checkboxDiv.classList.remove('hidden');
	      } else {
	        checkboxDiv.classList.add('hidden');
	      }
	    } else {
	      checkboxDiv.classList.remove('hidden');
	    }
	  });
	  
	  updateVisibleCount();
	}

	document.getElementById('minPrice').addEventListener('input', applyPriceFilter);
	document.getElementById('maxPrice').addEventListener('input', applyPriceFilter);

	document.getElementById('resetPriceFilter').addEventListener('click', function() {
	  document.getElementById('minPrice').value = '';
	  document.getElementById('maxPrice').value = '';
	  
	  const checkboxes = document.querySelectorAll('.vegetable-checkbox');
	  checkboxes.forEach(checkboxDiv => {
	    checkboxDiv.classList.remove('hidden');
	  });
	  
	  updateVisibleCount();
	});

	// åˆ¶å¾¡ãƒœã‚¿ãƒ³
	document.getElementById('selectAll').addEventListener('click', () => {
	  const checkboxes = document.querySelectorAll('#vegetableCheckboxes input[type="checkbox"]');
	  checkboxes.forEach(cb => cb.checked = true);
	  updateChart();
	});

	document.getElementById('deselectAll').addEventListener('click', () => {
	  const checkboxes = document.querySelectorAll('#vegetableCheckboxes input[type="checkbox"]');
	  checkboxes.forEach(cb => cb.checked = false);
	  updateChart();
	});

	document.getElementById('selectVisible').addEventListener('click', () => {
	  const checkboxes = document.querySelectorAll('#vegetableCheckboxes input[type="checkbox"]');
	  checkboxes.forEach(cb => {
	    const checkboxDiv = cb.closest('.vegetable-checkbox');
	    cb.checked = !checkboxDiv.classList.contains('hidden');
	  });
	  updateChart();
	});

	// ç¾åœ¨ã®APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
	const API_BASE_URL = 'https://script.google.com/macros/s/AKfycbwqyKyWKhGcS377C9XsPhoyjoG5GsJx8EMCd9qsazoanInvnvDcp1aWtgvVAUEZdLQ7/exec';

	// é‡èœä¸€è¦§ã¨ä¾¡æ ¼ã‚’å–å¾—
	async function loadVegetableList() {
	  try {
	    console.log('é‡èœä¸€è¦§ã¨ä¾¡æ ¼ã‚’å–å¾—ä¸­...');
	    
	    const response = await fetch(`${API_BASE_URL}?path=vegetables-list-with-prices`);
	    const result = await response.json();
	    
	    // ä»¥ä¸‹ã¯æ—¢å­˜ã®ã‚³ãƒ¼ãƒ‰ã¨åŒã˜
	    if (result.status === 'success') {
	      availableVegetables = result.data.list;
	      vegetablePrices = result.data.prices;
	      // ... ä»¥ä¸‹çœç•¥
	    }
	  } catch (error) {
	    console.error('é‡èœä¸€è¦§å–å¾—ã‚¨ãƒ©ãƒ¼:', error);
	  }
	}

	// APIã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
	async function fetchVegetableData() {
	  try {
	    console.log('APIã‹ã‚‰å±¥æ­´ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ä¸­...');
	    
	    const response = await fetch(`${API_BASE_URL}?path=vegetables-history`);
	    const result = await response.json();
	    
	    // ä»¥ä¸‹ã¯æ—¢å­˜ã®ã‚³ãƒ¼ãƒ‰ã¨åŒã˜
	    if (result.status === 'success') {
	      allVegetableData = result.data;
	      allDates = result.dates;
	      // ... ä»¥ä¸‹çœç•¥
	    }
	  } catch (error) {
	    console.error('fetch ã‚¨ãƒ©ãƒ¼:', error);
	    fallbackToBarChart();
	  }
	}

	// ã‚¨ãƒ©ãƒ¼æ™‚ã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
	async function fallbackToBarChart() {
	  try {
	    const response = await fetch(`${API_BASE_URL}?path=vegetables`);
	    const result = await response.json();
	    
	    if (result.status === 'success') {
	      createBarChart(result.data);
	    }
	  } catch (error) {
	    console.error('ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚‚ã‚¨ãƒ©ãƒ¼:', error);
	  }
	}

	function createBarChart(data) {
	  const ctx = document.getElementById('vegetableChart').getContext('2d');
	  
	  if (chartInstance) {
	    chartInstance.destroy();
	  }
	  
	  chartInstance = new Chart(ctx, {
	    type: 'bar',
	    data: {
	      labels: data.map(item => item.name),
	      datasets: [{
	        label: 'ä¾¡æ ¼ï¼ˆå††/kgï¼‰',
	        data: data.map(item => item.price),
	        backgroundColor: 'rgba(75, 192, 192, 0.6)',
	        borderColor: 'rgba(75, 192, 192, 1)',
	        borderWidth: 1
	      }]
	    },
	    options: {
	      responsive: true,
	      maintainAspectRatio: false,
	      scales: {
	        y: {
	          beginAtZero: true,
	          title: {
	            display: true,
	            text: 'ä¾¡æ ¼ï¼ˆå††/kgï¼‰'
	          }
	        }
	      },
	      plugins: {
	        title: {
	          display: true,
	          text: 'æ²–ç¸„çœŒé’æœå¸‚æ³ä¾¡æ ¼ï¼ˆæœ€æ–°ï¼‰'
	        }
	      }
	    }
	  });
	}

	// ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿å¾Œã®å‡¦ç†
	document.addEventListener('DOMContentLoaded', async function() {
	  await loadVegetableList();
	  await fetchVegetableData();
	});
  </script>
</body>
</html>